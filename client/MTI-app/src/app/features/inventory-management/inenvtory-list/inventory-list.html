<mat-card class="inventory-card">

  <mat-card-content>
    <div class="items-header">
      <h2>ITEMS</h2>
      <button mat-raised-button color="primary" (click)="addItem()">NEW ITEM</button>
    </div>



    <table mat-table [dataSource]="store.items()" class="mat-elevation-z2">

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>NAME</th>
        <td mat-cell *matCellDef="let item" class="name-column">{{ item.name }}</td>
      </ng-container>

      <!-- Description Column -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>DESCRIPTION</th>
        <td mat-cell *matCellDef="let item">{{ item.description }}</td>
      </ng-container>

      <!-- Category Column -->
      <ng-container matColumnDef="category">
        <th mat-header-cell *matHeaderCellDef>CATEGORY</th>
        <td mat-cell *matCellDef="let item">{{ item.category }}</td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>STATUS</th>
        <td mat-cell *matCellDef="let item">
          <div class="status-chip" [ngClass]="item.isCheckedOut ? 'borrowed' : 'available'">
            <mat-icon class="status-icon" aria-hidden="true">
              {{ item.isCheckedOut ? 'assignment_return' : 'check_circle' }}
            </mat-icon>
            <span>{{ item.isCheckedOut ? 'Borrowed' : 'Available' }}</span>
          </div>
        </td>
      </ng-container>
      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>ACTIONS</th>
        <td mat-cell *matCellDef="let item">

          <!-- Borrow / Return Button -->
          <button mat-icon-button matTooltip="{{ item.isCheckedOut ? 'Return Item' : 'Borrow Item' }}"
            (click)="item.isCheckedOut ? returnItem(item) : borrowItem(item)">
            <mat-icon>{{ item.isCheckedOut ? 'assignment_return' : 'assignment_turned_in' }}</mat-icon>
          </button>

          <!-- Edit Button -->
          <button mat-icon-button matTooltip="Edit" (click)="editItem(item.id)">
            <mat-icon>edit</mat-icon>
          </button>

          <!-- Delete Button  -->
          <button mat-icon-button matTooltip="Delete" (click)="deleteItem(item)">
            <mat-icon class="delete-icon">delete</mat-icon>
          </button>

        </td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    @if (store.isLoading()) {
    <div class="loading-spinner">
      <mat-spinner diameter="50"></mat-spinner>
    </div>
    }

    @if (!store.items()) {
    <div class="no-data-message">
      <mat-icon>inventory_2</mat-icon>
      <p>No items found</p>
    </div>
    }

  </mat-card-content>
</mat-card>